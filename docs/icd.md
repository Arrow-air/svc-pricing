# Interface Control Document (ICD) - `svc-pricing`

<center>

<img src="https://github.com/Arrow-air/tf-github/raw/main/src/templates/doc-banner-services.png" style="height:250px" />

</center>

## Overview

This document details the endpoints provided by the `svc-pricing` service.

Autogenerated client-side functions for this gRPC server are conveniently packaged in the `svc-pricing-client` crate, to be used by svc-cargo, svc-rideshare, and other customer-facing services.


Attribute | Description
--- | ---
Status | :yellow_circle: Development

## Related Documents

Document | Description
--- | ---
[Pricing Model](https://docs.google.com/spreadsheets/d/1mjPtaIn3E5m7r4nyKt_sJKG9BSFm2ty7Gzo7OqERxwo) | Unit economics and pricing mechanism of flights. The core logic of `svc-pricing` is largely derived from the pricing model.
[Uber Elevate White Paper](https://evtol.news/__media/PDFs/UberElevateWhitePaperOct2016.pdf) | Uber's research on UAM operations. Certain economic assumptions are referenced by Arrow's pricing model.
[High-Level Services ICD](https://github.com/Arrow-air/se-services/blob/develop/docs/icd.md) | Arrow Services team's top-level ICD.
[Concept of Operations - `svc-pricing`](conops.md) | Concept of Operations for `svc-pricing`.
[Software Design Document - `svc-pricing`](./sdd.md) | Software Design Document for `svc-pricing`.

## Frameworks

See the [High-Level Services ICD](https://github.com/Arrow-air/se-services/blob/develop/docs/icd.md).


## gRPC

### Files

These interfaces are defined in a protocol buffer file, [`svc-pricing-grpc.proto`](../proto/svc-pricing-grpc.proto).

### Integrated Authentication & Encryption

See [High-Level Services ICD](https://github.com/Arrow-air/se-services/blob/develop/docs/icd.md).

### gRPC Protocol Documentation

#### `ReadyResponse`
If the service is ready to use.


| Field | Type | Description |
| ----- | ---- | ----------- |
| `ready` | bool |  `true` if the service is ready, `false` otherwise. |


#### `PricingResponse`
Price for a given flight. 

| Field | Type | Description |
| ----- | ---- | ----------- |
| `price` | float | Price in USD |

#### `ReadyRequest`
A ping to a heartbeat service to see if `svc-pricing` is ready to use.


| Field | Type | Description |
| ----- | ---- | ----------- |
| `arbitrary` | bool  | An arbitrary value |

#### `PricingRequest`
Get the price for a type of service.

:exclamation: This is still WIP as we continue to refine our pricing model. For testing purposes, rideshare type will return a price that is half of that of cargo; and charter will be twice.

An extra field to be added in the near future is `weight` as the weight of the payload affects power consumption, which would influence the pricing.

Two required fields:
- `service_type`: the type of service. 0 = cargo, 1 = rideshare, 2 =
  charter
- `distance_km`: the distance of the trip in km

### gRPC Server Methods ("Services")

gRPC server methods are called "services", unfortunately name clashing with the broader concept of web services.
| Service | Description |
| ---- | ---- |
| `IsReady` | Returns a message indicating if this service is ready for requests.<br> <br>Similar to a health check, if a server is not "ready" it could be considered dead by the client making the request.<br> <br> Also see [`ReadyRequest`](#readyrequest), [`ReadyResponse`](#readyresponse).
| `GetPricing` | Returns a float value representing the price for a given flight trip, denominated in USD.<br> <br> Also see [`PricingRequest`](#pricingrequest), [`PricingResponse`](#pricingresponse).|

### gRPC Client Methods ("Requests")

| Request | Description |
| ------    | ------- |
| `PricingRequest` | See [`PricingRequest`](#pricingrequest)
| `ReadyRequest` | See [`ReadyRequest`](#readyrequest) |
